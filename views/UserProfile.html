<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <link rel="stylesheet" href="UserProfile.css">
    <script src="https://kit.fontawesome.com/d2a5bb0631.js" crossorigin="anonymous"></script>
</head>
<body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
    
    <nav class="navbar navbar-expand-lg bg-success bg-opacity-100 d-flex">
       
      <div class="container-fluid  d-flex ">
        

        <button class="navbar-toggler text-success" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon" style="color: white;"></span>
        </button>
        
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0 d-flex justify-content-evenly align-items-center " style="width: 90%;">
            
              
              <li class="nav-item ">
                  <a href="Home.html" class="nav-link text-white  active " ><h5>HOME</h5></a>
              </li>
              
              <li class="nav-item dropdown">
                  <a class="nav-link fw-bold text-white" href="#" role="button" data-bs-toggle="dropdown" >
                      <h5 class="dropdown-toggle">CATEGORIES
                  </h5></a>
                  <ul class="dropdown-menu">
                    <li><a class="dropdown-item" href="#">Appetizers</a></li>
                    <li><a class="dropdown-item" href="#">Main dishes</a></li>
                    <li><a class="dropdown-item" href="#">Desserts</a></li>
                    <li><a class="dropdown-item" href="#">Soups</a></li>
                    <li><a class="dropdown-item" href="#">Sides</a></li>
                    <li><a class="dropdown-item" href="#">Drinks</a></li>
                    <li><a class="dropdown-item" href="#">International cousines</a></li>
                    <li><a class="dropdown-item" href="#"></a></li>
                
                  
                  </ul>
                </li>

              <li class="nav-item">
                  <a href="UserProfile.html" class="nav-link text-white "><h5>MY PROFILE</h5></a>
              </li>
              <li class="nav-item">
                  <a href="Subscription.html" class="nav-link text-white "><h5>SUBSCRIPTION</h5></a>
              </li>

     
              <li class="nav-item">
                  <a href="About.html" class="nav-link text-white "><h5>ABOUT</h5></a>
              </li>

              
              
          </ul>
         
            <div>
              <a href="index.html"><button id="sign-in" class="btn fw-bold text-white border m-1">SIGN UP / LOG IN</button></a>
            </div>
        </div>
      </div>
    </nav>
    

    <div class="container  justify-content-center align-items-center d-flex" >
        <div class="d-flex flex-column justify-content-center align-items-center">
      <img src="./Profilepic.webp" id="propic" style="height: 300px; width: 300px;" >
        <h2 id="username" class="mt-4">Username</h2>
        <textarea name="" id="" cols="30" rows="4" class="form-control mt-3" placeholder="Add a bio to help people understand you better"></textarea>
      </div>
      <div class="p-4 mt-5 info container border w-50">    
        <h4>Date of Birth: <input type="date" id="dateofbirth" value="" /></h4>
        <h4>Gender: <input type="text" id="gender" value="" /></h4>
        <h4>Country: <input type="text" id="country" value="" /></h4>
        <h4>Email: <input type="email" id="email" value="" /></h4>
        <h4><span>Subscription:</span> Yes</h4>
        <button id="updateProfile">Update Profile</button>
          
          <div class="mt-2 d-flex">
            <h4 class="fw-bold"><span>Social Media:</span></h4>
            <a href="#"><i class="fa-brands fa-youtube fa-2xl me-3" style="color: #e93407;"></i> </a>

            <a href="#"><i class="fa-brands fa-facebook fa-2xl me-3" style="color: #075ced;"></i></a>
            <a href="#"><i class="fa-brands fa-instagram fa-2xl me-3" style="color: #f10979;"></i></a>
        </div>
        </div>
    </div>

     <!-----Third Part----->
   <div class="container-fluid d-flex align-items-center flex-column mt-5" style="width: 80%; font-family: Oleo-bold;">
    <div class=" d-flex align-items-end justify-content-center w-100 ">
         
      <div>
        <h1 class=" m-4 fw-bold mt-5"  >Uploaded Recipes â†’ </h1>     
    </div>

      
      <div>
          <h1 class=" m-4 fw-bold"  ></h1>
          
          
      </div>
    </div>
   
    <div id="recipesContainer" class="row mt-5 mb-5">
      
    </div>

    <div class="d-flex justify-content-center">
      <button class="btn-success btn m-4 mt-5"><a href="RecipeUp.html" class="text-white text-decoration-none">Upload New Recipe</a></button>
    </div>

    <script>
      function getCookie(name) {
          let cookieArray = document.cookie.split(";");
          for (let i = 0; i < cookieArray.length; i++) {
            let cookiePair = cookieArray[i].split("=");
            if (name == cookiePair[0].trim()) {
              return decodeURIComponent(cookiePair[1]);
            }
          }
          return null;
        }
  
        const username = getCookie("username");
        console.log(username);

      fetch("/profile/getUserProfile", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ username: username }),
      })
        .then((response) => response.json())
        .then((data) => {
          // Update the DOM with user data
          document.getElementById("username").innerHTML = data.username;
          document.getElementById("dateofbirth").value = new Date(data.birthdate).toISOString().split("T")[0];
          document.getElementById("gender").value = data.gender;
          document.getElementById("country").value = data.location;
          document.getElementById("email").value = data.email;

          // Add other user details similarly
        })
        .catch((error) => {
          console.error("Error:", error);
        });

      fetch("/recipeup/getUserRecipes", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({ username: username }),
      })
        .then((response) => response.json())
        .then((recipes) => {
          const recipesContainer = document.getElementById("recipesContainer"); // Assign an ID to your recipes container div
          recipesContainer.innerHTML = ""; // Clear existing contents

          recipes.forEach((recipe) => {
            // Create and append each recipe card to recipesContainer
            let cardHtml = `<div class="col-12 col-md-6 col-lg-3 h-100 g-2">
            <div class="card">
              <img src="./BlankBG.jpg" class="card-img" alt=${recipe.recipename} />
              <div class="card-body">
                <h4 class="card-title">${recipe.recipename}</h4>
                <p class="card-text">
                  ${recipe.recipenutrients}
                </p>
                <div class="d-flex justify-content-between align-items-center">
                  <button class="btn btn-success">View</button>
                  <p
                    class="fw-bolder me-3 mt-3"
                    style="color: rgb(141, 35, 35); font-family: Helvetica"
                  >
                    0.0 / 5
                  </p>
                </div>
              </div>
            </div>
          </div>
          `;
            recipesContainer.innerHTML += cardHtml;
          });
        })
        .catch((error) => {
          console.error("Error:", error);
        });
        document.getElementById("updateProfile").addEventListener("click", function() {
    const updatedData = {
        username: username,
        birthdate: document.getElementById("dateofbirth").value,
        gender: document.getElementById("gender").value,
        location: document.getElementById("country").value,
        email: document.getElementById("email").value
        // Add other fields as necessary
    };

    fetch("/profile/updateUserProfile", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
        },
        body: JSON.stringify(updatedData)
    })
    .then(response => response.text())
    .then(data => {
        alert(data); // Alert the response (e.g., "User updated successfully.")
    })
    .catch(error => {
        console.error("Error:", error);
        alert("An error occurred while updating the profile.");
    });
});
    </script>

</body>
</html>